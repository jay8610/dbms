create table o_rollcall (
rollno int primary key,
name varchar (20)
);

create table n_rollcall (
rollno int primary key,
name varchar (20)
);

insert into o_rollcall values 
(1, 'Ram'),
(2, 'Ravi'),
(3, 'Sarvesh');

insert into n_rollcall values 
(2, 'Ravi'),
(4, 'Jayesh');

delimiter //
create procedure p_merge()
begin
declare v_rollno int;
declare v_name varchar (20);
declare v_done int default 0;
declare c_students cursor for
select rollno, name
from o_rollcall
where rollno not in (select rollno from n_rollcall);
declare continue handler for not found set v_done = 1;
open c_students;
read_loop : loop
fetch c_students into v_rollno, v_name;
if v_done = 1 then 
leave read_loop;
end if;
insert into n_rollcall(rollno, name) values (v_rollno, v_name);
end loop;
close c_students;
end //

delimiter ;

call p_merge();
select * from n_rollcall;
